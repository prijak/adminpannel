define([
    'jquery',
    'Magento_Ui/js/modal/modal',
    'domReady!'
],
function($,modal) {
    return function(config, element) {
        var ajaxUrl = config.ajaxUrl;

        $(document).on('click', '#notify', function(){
            var optionProductId = $('.swatch-option.text.selected').attr('option-product-id');
            
            if (typeof optionProductId !== typeof undefined && optionProductId !== false) {
                var product_id = optionProductId;
            } else {
                var product_id = $('input[name=product]').val();
            }
            $("#product").val(product_id);
            var options = {
                type: 'popup',
                responsive: true,
                innerScroll: true,
                buttons: false,
                modalClass: 'notify-stock-popup',
                title: "In Stock Notification"
            };
            var popup = modal(options, $('#notify-popup'));
            $("#notify-popup").modal("openModal");
        });

        $('#notify-form').on('submit', function (e) {
            e.preventDefault();
            var product = $('input[id=product]').val();
            var name = $('input[id=name]').val();
            var email = $('input[id=emailid]').val();

            if ($('#notify-form').valid()) {
                $.ajax({
                    url: ajaxUrl,
                    type: "POST",
                    data: {product: product, emailid:email, name:name },
                    showLoader: true,
                    success: function(response) {
                        /*return true;*/
                        $('#notify-popup').modal('closeModal');
                        $('#notify-form')[0].reset();
                    }
                });
            }
        });
        if (!S(".product-grouped-qty").length) {
            $(document).on('click', '#product-addtocart-button', function(){
            var pincode = $('input[id=pincode_number]').val();
             if(pincode.length < 6 || pincode.length == 0)
             {
                 $('#pincode_number').focus();
                 $('.checkTxt').html('You need to enter your pincode before adding to cart, so we can ensure that there are no surprises when you checkout!');
                 return false;
             }
            });
        } 
    };
});
